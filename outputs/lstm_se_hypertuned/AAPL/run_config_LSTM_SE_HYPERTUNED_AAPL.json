{
  "reported_model_name": "LSTM (sentiment-enhanced) - monthly refit",
  "model_id": "LSTM_SE_TUNED",
  "ticker": "AAPL",
  "splits": {
    "train": [
      "2021-02-03",
      "2022-12-30"
    ],
    "val": [
      "2023-01-03",
      "2023-05-31"
    ],
    "test": [
      "2023-06-01",
      "2023-12-28"
    ],
    "n_test": 146
  },
  "cadence": "monthly_refit",
  "refit_dates": [
    "2023-06-01",
    "2023-07-03",
    "2023-08-01",
    "2023-09-01",
    "2023-10-02",
    "2023-11-01",
    "2023-12-01"
  ],
  "epochs_per_refit": [
    392,
    382,
    301,
    395,
    389,
    391,
    360
  ],
  "early_stopping": {
    "policy": {
      "patience": 15
    },
    "per_refit": [
      {
        "refit_index": 1,
        "refit_date": "2023-06-01",
        "epochs_run": 392,
        "best_epoch": 376,
        "best_val_loss": 25.1716484143896,
        "early_stop_triggered": true
      },
      {
        "refit_index": 2,
        "refit_date": "2023-07-03",
        "epochs_run": 382,
        "best_epoch": 366,
        "best_val_loss": 26.47063927511567,
        "early_stop_triggered": true
      },
      {
        "refit_index": 3,
        "refit_date": "2023-08-01",
        "epochs_run": 301,
        "best_epoch": 285,
        "best_val_loss": 238.22323045452822,
        "early_stop_triggered": true
      },
      {
        "refit_index": 4,
        "refit_date": "2023-09-01",
        "epochs_run": 395,
        "best_epoch": 379,
        "best_val_loss": 22.43077154066956,
        "early_stop_triggered": true
      },
      {
        "refit_index": 5,
        "refit_date": "2023-10-02",
        "epochs_run": 389,
        "best_epoch": 373,
        "best_val_loss": 22.71781565842119,
        "early_stop_triggered": true
      },
      {
        "refit_index": 6,
        "refit_date": "2023-11-01",
        "epochs_run": 391,
        "best_epoch": 375,
        "best_val_loss": 26.23594265539669,
        "early_stop_triggered": true
      },
      {
        "refit_index": 7,
        "refit_date": "2023-12-01",
        "epochs_run": 360,
        "best_epoch": 344,
        "best_val_loss": 50.94784649598946,
        "early_stop_triggered": true
      }
    ]
  },
  "parameter_count": 33649,
  "seeds": {
    "python": 1337,
    "numpy": 1337,
    "torch": 1337,
    "cuda_seed": null
  },
  "window_length": 90,
  "batch_size": 32,
  "tuned_hyperparameters": {
    "hidden_size": 48,
    "num_layers": 2,
    "dropout": 0.0,
    "optim": "AdamW",
    "lr": 0.001,
    "batch_size": 32,
    "patience": 15,
    "weight_decay": 0.0001,
    "grad_clip_norm": 1.0,
    "seq_len": 90
  },
  "target_scaling": "none",
  "inverse_transform_applied": false,
  "features_used": [
    "Close",
    "High",
    "LogRet_1d",
    "Low",
    "MACD",
    "MACD_Signal",
    "Nw_SP500_active_rl",
    "Nw_SP500_burst_day",
    "Nw_SP500_count_items",
    "Nw_SP500_ewma3_s",
    "Nw_SP500_ewma7_s",
    "Nw_SP500_mean_p_neg",
    "Nw_SP500_mean_p_neu",
    "Nw_SP500_mean_p_pos",
    "Nw_SP500_mean_s",
    "Nw_SP500_median_s",
    "Nw_SP500_q10_s",
    "Nw_SP500_q90_s",
    "Nw_SP500_zero_day",
    "Open",
    "RSI_14",
    "Return_1d",
    "SMA_21",
    "SMA_7",
    "Vol_21",
    "Vol_7",
    "Volume"
  ],
  "features_sha256": "7514eba8d4d1458a93da81e37410ca16a27286f756d05a76966c4d095c7115fe",
  "sentiment_zero_columns": [
    "Nw_SP500_active_rl",
    "Nw_SP500_burst_day",
    "Nw_SP500_count_items",
    "Nw_SP500_ewma3_s",
    "Nw_SP500_ewma7_s",
    "Nw_SP500_mean_p_neg",
    "Nw_SP500_mean_p_neu",
    "Nw_SP500_mean_p_pos",
    "Nw_SP500_mean_s",
    "Nw_SP500_median_s",
    "Nw_SP500_q10_s",
    "Nw_SP500_q90_s",
    "Nw_SP500_zero_day"
  ],
  "clock_invariants": {
    "market_timezone": "America/New_York",
    "cutoff_local_time": "16:00:00",
    "no_forward_fill_past_cutoff": true,
    "sentiment_zero_encoding_on_no_activity_days": true
  },
  "tuning_meta": {
    "ticker": "AAPL",
    "search_space": {
      "hidden_size": [
        32,
        48,
        64,
        96
      ],
      "num_layers": [
        1,
        2
      ],
      "dropout": [
        0.0,
        0.1,
        0.2
      ],
      "optim": [
        "Adam",
        "AdamW"
      ],
      "lr": [
        0.0001,
        0.0003,
        0.001
      ],
      "batch_size": [
        32,
        64
      ],
      "patience": [
        10,
        15
      ],
      "weight_decay": [
        0.0,
        0.0001
      ],
      "grad_clip_norm": [
        null,
        1.0
      ]
    },
    "n_trials": 24,
    "best_trial_id": 16,
    "search_seed": 1337,
    "val_objective": "RMSE",
    "tie_break": "MAE",
    "log_path": "LSTM_SE_TUNED_FINAL/hypertune/AAPL/search_log_AAPL.csv",
    "best_val": {
      "rmse": 4.531920433044434,
      "mae": 3.753446102142334,
      "u2": 1.4563586746112853
    },
    "best_params": {
      "hidden_size": 48,
      "num_layers": 2,
      "dropout": 0.0,
      "optim": "AdamW",
      "lr": 0.001,
      "batch_size": 32,
      "patience": 15,
      "weight_decay": 0.0001,
      "grad_clip_norm": 1.0,
      "seq_len": 90
    }
  },
  "device": "cpu"
}